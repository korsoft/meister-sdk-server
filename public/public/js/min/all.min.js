var meister=angular.module("meister",["ngMaterial","ngAnimate","ngSanitize","ngMessages","ngAria","ui.router","ngCookies","md.data.table","chart.js","TreeWidget","angular-oauth2","ng.jsoneditor","angular-loading-bar","ui.ace","ang-drag-drop","blockUI"]);meister.constant("SERVER_BASE_URL","http://localhost:8000"),meister.constant("CLIENT_SECRET_KEY","GzkU62Ruwo29riFgJHVDPw377k8hYu5dXXYxgYSR"),meister.constant("SYSTEM_ADMIN",99),meister.constant("SYSTEM_INTEGRATOR",89),meister.constant("CLIENT_ADMIN",49),meister.constant("CLIENT_USER",29),meister.constant("COOKIE_LAST_REQUEST","meister-sdk-last-request"),meister.constant("COOKIE_MAX_TIMEOUT_REQUEST",60),function(e){e.config(["$stateProvider","$compileProvider","$mdDateLocaleProvider","$urlRouterProvider","OAuthProvider","OAuthTokenProvider","SERVER_BASE_URL","CLIENT_SECRET_KEY","cfpLoadingBarProvider",function(e,n,t,o,i,l,r,s,a){t.formatDate=function(e){return moment(e).format("YYYY-MM-DD")},a.includeSpinner=!1,n.preAssignBindingsEnabled(!0),l.configure({name:"meister-sdk-token",options:{secure:!1}}),i.configure({baseUrl:r,clientId:"2",clientSecret:s,grantPath:"/api/login",revokePath:"/api/logout"}),o.otherwise("/home"),e.state("login",{url:"/login",templateUrl:"partials/login-partial.html",controller:"LoginController"}).state("home",{url:"/home",templateUrl:"partials/home-partial.html",controller:"HomeController"}).state("clients",{url:"/clients",templateUrl:"partials/clients-partial.html",controller:"ClientController"}).state("users",{url:"/users",templateUrl:"partials/users-partial.html",controller:"UserController"}).state("edit-profile",{url:"/edit-profile",templateUrl:"partials/edit-profile-partial.html",controller:"EditProfileController"}).state("gateways",{url:"/gateways",templateUrl:"partials/client-gateways-partial.html",controller:"ClientGatewayController"}).state("requests-logs",{url:"/requestlogs",templateUrl:"partials/request-logs-partial.html",controller:"RequestLogsController"})}]).run(["$rootScope","$location","$mdToast","OAuth",function(e,n,t,o){e.OAuth=o,e.$on("$locationChangeStart",function(e,t,i){console.log("locationChangeStart---\x3e"),"/login"===n.path()||o.isAuthenticated()||n.path("/login")}),e.$on("oauth:error",function(e,i){if(console.log("oauth:error---\x3e"),"invalid_grant"!==i.data.error)return"invalid_token"===i.data.error?o.getRefreshToken():(t.show(t.simple().textContent(i.data.error).position("top").highlightClass("md-warn").hideDelay(3e3)),n.path("/login"))})}]),e.factory("httpResponseInterceptor",["$q","$timeout","$rootScope","$location","$cookies","COOKIE_LAST_REQUEST","COOKIE_MAX_TIMEOUT_REQUEST",function(e,n,t,o,i,l,r){return{request:function(n){var o=i.get(l);if(o){var s=Date.now(),a=s-o,c=Math.round(a/6e4);console.log("resultInMinutes",c),c>r&&(console.log("Revoke token authentication..."),t.logout())}i.put(l,Date.now());var d=e.defer();return d.resolve(n),d.promise},responseError:function(n){return 401===n.status&&(console.log("401 ERROR"),i.remove("meister-sdk-token"),o.path("/login")),e.reject(n)}}}]),e.config(function(e){e.interceptors.push("httpResponseInterceptor")}),e.config(function(e){e.template='  <div class="block-ui-overlay"></div>    <div class="block-ui-message-container">     <div class="block-ui-message">       <img src="./public/images/loading.gif"  width="64px">     </div>  </div>'})}(meister),function(e){e.factory("AuthenticationService",["OAuth",function(e){var n={};return n.Login=function(n,t){return e.getAccessToken({username:n,password:t,email:n})},n.Logout=function(){return e.revokeToken()},n}])}(meister),function(e){e.factory("apiUtils",["$http","SERVER_BASE_URL",function(e,n){var t=n+"/api",o=function(e,n,o,i){var l={};return l.method=e,l.url=t+n,l.params=o||{},i&&(l.data=i),l},i={};return i.get=function(n,t,i){var l=o("GET",n,t,null);e(l).then(function(e){i(null,e.data)},function(e){i(e,null)})},i.post=function(n,t,i){var l=o("POST",n,null,t);e(l).then(function(e){i(null,e.data)},function(e){i(e,null)})},i.put=function(n,t,i){var l=o("PUT",n,null,t);e(l).then(function(e){i(null,e.data)},function(e){i(e,null)})},i.del=function(n,t,i){var l=o("DELETE",n,t,i);e(l).then(function(e){i(null,e.data)},function(e){i(e,null)})},i}])}(meister),function(e){e.factory("ClientService",["$http","SERVER_BASE_URL",function(e,n){var t={};return t.index=function(){return e.get(n+"/api/clients")},t.store=function(t){return e.post(n+"/api/clients",t)},t.show=function(t){return e.get(n+"/api/clients/"+t)},t.update=function(t,o){return e.put(n+"/api/clients/"+t,o)},t.destroy=function(t){return e.delete(n+"/api/clients/"+t)},t}])}(meister),function(e){e.factory("GatewayClientService",["$http","SERVER_BASE_URL",function(e,n){var t={};return t.getbyGatewayId=function(t){return e.get(n+"/api/clientgatewayrelation/getbygatewaytidandcurrentuser/"+t)},t.store=function(t){return e.post(n+"/api/clientgatewayrelation",t)},t.update=function(t,o){return e.put(n+"/api/clientgatewayrelation/"+t,o)},t.destroy=function(t){return e.delete(n+"/api/clientgatewayrelation/"+t)},t}])}(meister),function(e){e.factory("GatewayService",["$http","SERVER_BASE_URL",function(e,n){var t={};return t.index=function(){return e.get(n+"/api/clientgateways")},t.store=function(t){return e.post(n+"/api/clientgateways",t)},t.show=function(t){return e.get(n+"/api/clientgateways/"+t)},t.update=function(t,o){return e.put(n+"/api/clientgateways/"+t,o)},t.destroy=function(t){return e.delete(n+"/api/clientgateways/"+t)},t.test_connection=function(t){return e.get(n+"/api/clientgateways/"+t+"/test_connection")},t.execute=function(t,o){return e({url:n+"/api/clientgateways/"+t+"/execute",method:"GET",params:o})},t.execute_changes=function(t,o){return e.post(n+"/api/clientgateways/"+t+"/execute",o)},t.execute_endpoint=function(t,o){return e.post(n+"/api/clientgateways/"+t+"/execute_endpoint",o)},t.buildJsonByNewProject=function(e,n){console.log("buildJsonByNewProject..."),console.log("json",e),console.log("project",n);var t={};return t.PKY=n.PKY?n.PKY:"",t.PROJECT=n.PROJECT,t.LOGICAL_DELETE=n.LOGICAL_DELETE,t.MEISTER_OWN=n.MEISTER_OWN,t.MODULES=[],t.STYLE_LIB=[],t},t.buildJsonByNewModule=function(e,n,t){console.log("buildJsonByNewEndpoint..."),console.log("json",e),console.log("parentNode",n),console.log("module",t);var o={},i=_.find(e,function(e){return e.PKY==n.PKY});if(i){console.log("project",i),o.PKY=i.PKY,o.PROJECT=i.PROJECT,o.LOGICAL_DELETE=i.LOGICAL_DELETE,o.MEISTER_OWN=i.MEISTER_OWN,o.MODULES=[];var l={PKY:t.PKY,FKY:i.PKY,NAME:t.NAME,LOGICAL_DELETE:t.LOGICAL_DELETE,MEISTER_OWN:t.MEISTER_OWN,DATE:moment(t.DATE).format("YYYYMMDD")};o.MODULES.push(l)}return o},t.buildJsonByNewEndpoint=function(e,n,t){console.log("buildJsonByNewEndpoint..."),console.log("json",e),console.log("parentNode",n),console.log("endpoint",t);var o={},i=_.find(e,function(e){return e.PKY==n.FKY});if(i){console.log("project",i),o.PKY=i.PKY,o.PROJECT=i.PROJECT,o.MODULES=[];var l=_.find(i.MODULES,function(e){return e.PKY==n.PKY});if(console.log("module",l),l){var r={PKY:l.PKY,FKY:i.PKY,NAME:l.NAME,DATE:l.DATE.split("-").join(""),MEISTER_OWN:l.MEISTER_OWN,LOGICAL_DELETE:l.LOGICAL_DELETE,ENDPOINTS:[]};t.FKY=l.PKY,r.ENDPOINTS.push(angular.copy(t)),o.MODULES.push(r)}}return o},t.buildJsonByNewStyle=function(e,n,t){console.log("buildJsonByNewStyle..."),console.log("json",e),console.log("parentNode",n),console.log("style",t);var o={},i=_.find(e,function(e){return e.PKY==n.source.parent.FKY});if(i){o.PKY=i.PKY,o.PROJECT=i.PROJECT,o.MODULES=[];var l=_.find(i.MODULES,function(e){return e.PKY==n.FKY});if(console.log("project",i),l){var r={PKY:l.PKY,NAME:l.NAME,DATE:l.DATE.split("-").join(""),MEISTER_OWN:l.MEISTER_OWN,LOGICAL_DELETE:l.LOGICAL_DELETE,ENDPOINTS:[]},s=_.find(m.ENDPOINTS,function(e){return e.PKY==n.PKY});s&&(s.STYLES=[],s.STYLES.push(t),r.ENDPOINTS.push(s),o.MODULES.push(r))}}return o},t.buildJsonByNewStyleTemplate=function(e,n,t){var o={},i=_.find(e,function(e){return e.PKY==n.PKY});return console.log("project",i),o.PKY=i.PKY,o.PROJECT=i.PROJECT,o.STYLE_LIB=[],t.FKY=i.PKY,o.STYLE_LIB.push(t),o},t}])}(meister),function(e){e.factory("MessageUtil",["$mdToast",function(e){var n={};return n.showError=function(n){e.show(e.simple().textContent(n).position("top right").theme("error-toast").hideDelay(3e3))},n.showInfo=function(n){e.show(e.simple().textContent(n).position("top right").hideDelay(3e3))},n}])}(meister),function(e){e.factory("RequestLogService",["$http","SERVER_BASE_URL",function(e,n){var t={};return t.index=function(t){return e.get(n+"/api/requestlogs",{params:t})},t.deleteAll=function(){return e.delete(n+"/api/requestlogs/all")},t}])}(meister),function(e){e.factory("UserClientRoleService",["$http","SERVER_BASE_URL",function(e,n){var t={};return t.getByUserId=function(t){return e.get(n+"/api/clientuserrole/byuserid/"+t)},t.store=function(t){return e.post(n+"/api/clientuserrole",t)},t.update=function(t,o){return e.put(n+"/api/clientuserrole/"+t,o)},t.destroy=function(t){return e.delete(n+"/api/clientuserrole/"+t)},t}])}(meister),function(e){e.factory("UserService",["$http","SERVER_BASE_URL",function(e,n){var t={};return t.index=function(){return e.get(n+"/api/users")},t.store=function(t){return e.post(n+"/api/users",t)},t.show=function(t){return e.get(n+"/api/users/"+t)},t.update=function(t,o){return e.put(n+"/api/users/"+t,o)},t.destroy=function(t){return e.delete(n+"/api/users/"+t)},t.types=function(){return e.get(n+"/api/types")},t.update_my_user=function(t,o){return e.put(n+"/api/users/"+t+"/update_my_user",o)},t.changeDefault=function(t){return e.post(n+"/api/users/changedefault/"+t)},t}])}(meister),function(e){e.controller("BapiDialogController",["$scope","GatewayService","MessageUtil",function(e,n,t){e.selector="O",e.selection="";var o=null,i=function(e){var n=e.toLowerCase().split(" "),t="";return _.each(n,function(e){t+=e.charAt(0).toUpperCase()+e.slice(1)+" "}),t};e.initBAPI=function(e){console.log(e),o=e},e.send=function(){var l={SELECTOR:e.selector,SELECTION:e.selection},r={endpoint:"Meister.SDK.Bapi.Lookup",json:JSON.stringify(l)};o&&o.id&&(r.client_number=o.sap_number),console.log("gatewayId",e.gatewaySelectedId),console.log("params",r),e.promise=n.execute_endpoint(e.gatewaySelectedId,r),e.promise.then(function(n){e.bapi.children.splice(0,e.bapi.children.length),console.log("result",n),n.data&&n.data.data&&_.each(n.data.data,function(n){n.EXPLORER&&_.each(n.EXPLORER,function(n){node={name:n.FUNCTION_NAME,source:n,parent:e.bapi,disabled:!1,type:"BAPI_NODE",children:[]},e.bapi.children.push(node),_.each(n,function(e,t,o){if(""!=e&&"FUNCTION_NAME"!=t&&"FUNCTION_GROUP"!=t){var l=t.split("_").join(" "),r={name:i(l)+':"'+e+'"',source:n,parent:node,disabled:!1,type:"BAPI_SUBNODE",children:[]};node.children.push(r)}})})}),e.$emit("hide_bapi_node",{})},function(e){console.log("error",e),t.showError(e.data.message)})}}])}(meister),function(e){e.controller("ClientController",["$scope","$location","$mdToast","$mdDialog","ClientService","MessageUtil",function(e,n,t,o,i,l){e.clients=[],e.promise=null,e.filter={show:!1},e.query={order:"name",limit:5,page:1,filter:""},e.limitOptions=[5,10,25,50,100],e.removeFilter=function(){e.filter.show=!1,e.query.filter=""},e.init=function(){console.log("ClientController init..."),e.promise=i.index(),e.promise.then(function(n){console.log("result",n),e.clients=n.data},function(e){console.log("failure login",e),l.showError(e.data.message)})},e.add=function(n,t){o.show({controller:"ClientDialogController",templateUrl:"templates/client-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{client:null}}).then(function(n){l.showInfo("Client was created"),e.init()},function(){})},e.edit=function(n,t){o.show({controller:"ClientDialogController",templateUrl:"templates/client-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{client:t}}).then(function(n){l.showInfo("Client was updated"),e.init()},function(){})},e.delete=function(n,t){var r=o.confirm().title("You are about to delete the following").htmlContent("Client "+t.name).targetEvent(n).ok("Yes").cancel("No");o.show(r).then(function(){e.promise=i.destroy(t.id),e.promise.then(function(n){l.showInfo("Client was deleted"),e.init()},function(e){l.showError(e.data.message)})},function(){})}}])}(meister),function(e){e.controller("ClientDialogController",["$scope","$mdDialog","client","ClientService","MessageUtil",function(e,n,t,o,i){e.client={},e.promise=null,e.cancel=function(){n.cancel()},t?e.client=angular.copy(t):(e.client.name="",e.client.sap_number=""),console.log("Client",t),e.save=function(){e.client.id?e.promise=o.update(e.client.id,e.client):e.promise=o.store(e.client),e.promise.then(function(e){console.log("result",e),n.hide(e)},function(e){console.log("error",e),i.showError(e.data.message)})}}])}(meister),function(e){e.controller("ClientGatewayController",["$scope","$rootScope","$location","$mdToast","$mdDialog","MessageUtil","GatewayService",function(e,n,t,o,i,l,r){e.gateways=[],e.promise=null,e.editR=n.user_type()==n.SYSTEM_ADMIN,e.filter={show:!1},e.query={order:"name",limit:5,page:1,filterByName:""},e.limitOptions=[5,10,25,50,100],e.removeFilter=function(){e.filter.show=!1,e.query.filterByName=""},e.init=function(){console.log("ClientGatewayController init..."),e.promise=r.index(),e.promise.then(function(n){console.log("result",n),e.gateways=n.data},function(e){console.log("failure",e),l.showError(e.data.message)})},n.$on("default_client_change",function(){e.init()}),e.add=function(n,t){i.show({controller:"ClientGatewayDialogController",templateUrl:"templates/client-gateway-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{gateway:null}}).then(function(n){l.showInfo("Gateway was created"),e.init()},function(){})},e.type=function(e){return 0==e?"BASIC":1==e?"FORM":2==e?"DIGEST":3==e?"OAUTH":4==e?"OAUTH2":""},e.edit=function(n,t){i.show({controller:"ClientGatewayDialogController",templateUrl:"templates/client-gateway-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{gateway:t}}).then(function(n){l.showInfo("Gateway was updated"),e.init()},function(){})},e.delete=function(n,t){var o=i.confirm().title("You are about to delete the following").htmlContent("Gateway "+t.name).targetEvent(n).ok("Yes").cancel("No");i.show(o).then(function(){e.promise=r.destroy(t.id),e.promise.then(function(n){l.showInfo("Gateway was deleted"),e.init()},function(e){l.showError(e.data.message)})},function(){})},e.test_connection=function(n,t){e.promise=r.test_connection(t.id),e.promise.then(function(e){l.showInfo("Connection successful")},function(e){l.showError(e.data.message)})},e.editClient=function(e,n){i.show({controller:"GatewayClientsDialogController",templateUrl:"templates/gateway-client-dialog-form.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!1,escapeToClose:!1,locals:{gateway:n}}).then(function(e){},function(){})}}])}(meister),function(e){e.controller("ClientGatewayDialogController",["$scope","$rootScope","$mdDialog","gateway","GatewayService","ClientService","MessageUtil",function(e,n,t,o,i,l,r){e.gateway={},e.types=[{id:0,name:"BASIC"},{id:1,name:"FORM"},{id:2,name:"DIGEST"},{id:3,name:"OAUTH"},{id:4,name:"OAUTH2"}],e.promise=null,e.cancel=function(){t.cancel()},o?e.gateway=angular.copy(o):(e.gateway.name="",e.gateway.url="",e.gateway.username="",e.gateway.password="",e.gateway.auth_type=0,e.gateway.digest="",e.gateway.consumer_key="",e.gateway.consumer_secret="",e.gateway.token="",e.gateway.token_secret="",e.gateway.client_id_for_oauth2="",e.gateway.client_secret_for_oauth2="",e.gateway.auth_url_for_oauth2=""),console.log("gateway",o),e.changeAuthType=function(n){e.gateway.auth_type=n,2!=n&&(e.gateway.digest=""),3!=n&&(e.gateway.consumer_key="",e.gateway.consumer_secret="",e.gateway.token="",e.gateway.token_secret="",e.gateway.username="",e.gateway.password=""),4!=n&&(e.gateway.client_id_for_oauth2="",e.gateway.client_secret_for_oauth2="",e.gateway.auth_url_for_oauth2="")},e.save=function(){e.gateway.id?e.promise=i.update(e.gateway.id,e.gateway):e.promise=i.store(e.gateway),e.promise.then(function(e){console.log("result",e),t.hide(e)},function(e){console.log("error",e),r.showError(e.data.message)})}}])}(meister),function(e){e.controller("EditProfileController",["$scope","$rootScope","$mdToast","UserService","MessageUtil",function(e,n,t,o,i){e.user={},e.repassword="",e.promise=null,e.init=function(){console.log("EditProfileController init..."),e.promise=o.show(n.user_id()),e.promise.then(function(n){console.log("result",n),e.user=n.data,e.user.password=""},function(e){console.log("failure login",e),i.showError(e.data.message)})},e.update=function(){e.promise=o.update_my_user(n.user_id(),e.user),e.promise.then(function(n){i.showInfo("User was updated"),e.user.password="",e.repassword=""},function(e){console.log("failure login",e),i.showError(e.data.message)})}}])}(meister),function(e){e.controller("EndpointController",["$scope","GatewayService","MessageUtil",function(e,n,t){e.page=1,e.valid=!1,e.uniqueName=!1,e.band_i=1,e.band_o=1;var o=null,i=null,l=null,r=null,s=null,a={};e.endpoint={},e.init=function(n,t,c,d,u,p,g){a=t,o=c,i=d,l=u,r=p,s=g,console.log("client",u),console.log("EndpointController--\x3eparentNode",a),n?e.endpoint=angular.copy(n):(e.endpoint.PKY="",e.endpoint.NAMESPACE="",e.endpoint.LONG_TEXT="",e.endpoint.ENDPOINT_MAIN="",e.endpoint.HANDLER="",e.endpoint.BUS_NAME="",e.endpoint.TYPE="",e.endpoint.VERSION="",e.endpoint.LOCKED="",e.endpoint.PACKAGE="",e.endpoint.TRANSPORT="",e.endpoint.STYLES=[{PKY:"",DIRECTION:"I",NAME:"Default",JSON:"",CLASS_NAME:"",BAND:!1},{PKY:"",DIRECTION:"O",NAME:"Default",JSON:"",CLASS_NAME:"",BAND:!1}]),console.log("Endpoint",n),console.log("ParenNode",e.parentNode)},e.promise=null,e.cancel=function(){e.$emit("add-endpoint-closed",{})},e.$watch("endpoint.NAMESPACE",function(){e.uniqueName=!0,_.forEach(r,function(n){n==e.endpoint.NAMESPACE&&(e.uniqueName=!1)})}),e.$watch("endpoint.ENDPOINT_MAIN",function(){e.uniqueMain=!0,_.forEach(s,function(n){n==e.endpoint.ENDPOINT_MAIN&&(e.uniqueMain=!1)})}),e.format_json=function(e){e.source.$JSON=JSON.stringify(JSON.parse(e.source.JSON),null,"\t")},e.dropValidate=function(e,n){return console.log("target",e),console.log("source",n),!n.NAME},e.onDrop=function(e,n,t){console.log("onDrop",n),n.DIRECTION?t.JSON="":t.JSON=JSON.stringify(JSON.parse(n.JSON),null,"\t")},e.changeJSON=function(n){for(var t=0;t<e.endpoint.STYLES.length;t++)if(e.endpoint.STYLES[t].JSON.length>0)try{jj=JSON.parse(e.endpoint.STYLES[t].JSON),Object.keys(jj).length>0?e.valid=!0:e.valid=!1}catch(n){e.valid=!1;break}else e.valid=!1},e.check_json=function(){return console.log("json",i),!!JSON.parse(i)},e.save=function(){console.log("Save",e.endpoint);var r=angular.copy(e.endpoint);_.each(r.STYLES,function(e){delete e.BAND;var n=angular.fromJson(e.JSON.replace(/"([\w\s]+)":/g,function(e){return e.replace(/\s+/g,"")}));e.JSON=angular.toJson(n)}),console.log("localEndpoint",r),r.HANDLER=r.HANDLER.toUpperCase(),r.ENDPOINT_MAIN=r.ENDPOINT_MAIN.toUpperCase(),r.PACKAGE=r.PACKAGE.toUpperCase();var s=n.buildJsonByNewEndpoint(i,a.source,r),c={json:angular.toJson(s)};l&&l.id&&(c.client_number=l.sap_number),console.log("params",c),e.promise=n.execute_changes(o.id,c),e.promise.then(function(n){console.log("result",n),e.$emit("add-endpoint-saved",{parentNode:a,endpoint:r})},function(e){console.log("error",e),t.showError(e.data.message)})},e.changePage=function(n){e.page=n},e.addStyle=function(){e.band_i++,e.endpoint.STYLES.push({PKY:"",DIRECTION:"O",NAME:"",JSON:"",CLASS_NAME:"",BAND:e.band_i>1})},e.deleteStyle=function(n){"I"===e.endpoint.STYLES[n].DIRECTION&&e.band_i--,"O"===e.endpoint.STYLES[n].DIRECTION&&e.band_o--,e.endpoint.STYLES.splice(n,1)},e.verifyStyles=function(){_foreach(e.endpoint.STYLES,function(n){"I"===n.DIRECTION&&(e.band_i=!0),"O"===n.DIRECTION&&(e.band_o=!0)}),console.log("Verifyng value")},e.directionChanged=function(n){var t=0,o=0;_foreach(e.endpoint.STYLES,function(e){"I"===e.DIRECTION&&t++,"O"===e.DIRECTION&&o++}),e.band_i=t,e.band_o=o,console.log("Style Direction: "+n.DIRECTION+"$scope.band_o: "+e.band_o+"$scope.band_i"+e.band_i)},e.checkUniqueName=function(){var n=[];if(!e.endpoint.STYLES)return!1;for(var t=0;t<e.endpoint.STYLES.length;t++){if(void 0!==n[e.endpoint.STYLES[t].NAME+e.endpoint.STYLES[t].DIRECTION])return!0;n[e.endpoint.STYLES[t].NAME+e.endpoint.STYLES[t].DIRECTION]=1}return!1}}])}(meister),function(e){e.controller("EndpointDialogController",["$scope","$mdDialog","endpoint","parentNode","gateway","json","client","GatewayService","MessageUtil","endpoints_names","endpoints_main","style_library",function(e,n,t,o,l,r,s,a,c,d,u,p){e.endpoint={},e.parentNode={},e.page=1,e.valid=!1,e.uniqueName=!1,e.band_i=1,e.band_o=1,e.style_library=angular.copy(p),e.promise=null,e.cancel=function(){n.cancel()},console.log("style_library",p),e.$watch("endpoint.NAMESPACE",function(){e.uniqueName=!0,_.forEach(d,function(n){n==e.endpoint.NAMESPACE&&(e.uniqueName=!1)})}),e.$watch("endpoint.ENDPOINT_MAIN",function(){e.uniqueMain=!0,_.forEach(u,function(n){n==e.endpoint.ENDPOINT_MAIN&&(e.uniqueMain=!1)})}),e.format_json=function(e){e.source.$JSON=JSON.stringify(JSON.parse(e.source.JSON),null,"\t")},e.onDrop=function(e,n,t){console.log("onDrop",n),t.JSON=n.$JSON},e.changeJSON=function(n){for(var t=0;t<e.endpoint.STYLES.length;t++)if(e.endpoint.STYLES[t].JSON.length>0)try{jj=JSON.parse(e.endpoint.STYLES[t].JSON),Object.keys(jj).length>0?e.valid=!0:e.valid=!1}catch(n){e.valid=!1;break}else e.valid=!1},t?e.endpoint=angular.copy(t):(e.endpoint.PKY="",e.endpoint.NAMESPACE="",e.endpoint.LONG_TEXT="",e.endpoint.ENDPOINT_MAIN="",e.endpoint.HANDLER="",e.endpoint.BUS_NAME="",e.endpoint.TYPE="",e.endpoint.VERSION="",e.endpoint.LOCKED="",e.endpoint.PACKAGE="",e.endpoint.TRANSPORT="",e.endpoint.STYLES=[{PKY:"",DIRECTION:"I",NAME:"Default",JSON:"",CLASS_NAME:"",BAND:!1},{PKY:"",DIRECTION:"O",NAME:"Default",JSON:"",CLASS_NAME:"",BAND:!1}]),e.parentNode=o,console.log("Endpoint",t),console.log("ParenNode",o),e.check_json=function(){return console.log("json",r),!!JSON.parse(r)},e.save=function(){var t=a.buildJsonByNewEndpoint(r,o.source,e.endpoint),i={json:angular.toJson(t)};s&&s.id&&(i.client_number=s.sap_number),console.log("params",i),e.promise=a.execute_changes(l.id,i),e.promise.then(function(e){console.log("result",e),n.hide(e)},function(e){console.log("error",e),c.showError(e.data.message)})},e.changePage=function(n){e.page=n},e.addStyle=function(){e.band_i++,e.endpoint.STYLES.push({PKY:"",DIRECTION:"I",NAME:"",JSON:"",CLASS_NAME:"",BAND:e.band_i>1})},e.deleteStyle=function(n){"I"===e.endpoint.STYLES[i].DIRECTION&&e.band_i--,"O"===e.endpoint.STYLES[i].DIRECTION&&e.band_o--,e.endpoint.STYLES.splice(n,1)},e.verifyStyles=function(){_foreach(e.endpoint.STYLES,function(n){"I"===n.DIRECTION&&(e.band_i=!0),"O"===n.DIRECTION&&(e.band_o=!0)}),console.log("Verifyng value")},e.directionChanged=function(n){var t=0,o=0;_foreach(e.endpoint.STYLES,function(e){"I"===e.DIRECTION&&t++,"O"===e.DIRECTION&&o++}),e.band_i=t,e.band_o=o,console.log("Style Direction: "+n.DIRECTION+"$scope.band_o: "+e.band_o+"$scope.band_i"+e.band_i)},e.checkUniqueName=function(){for(var n=[],t=0;t<e.endpoint.STYLES.length;t++){if(void 0!==n[e.endpoint.STYLES[t].NAME+e.endpoint.STYLES[t].DIRECTION])return!0;n[e.endpoint.STYLES[t].NAME+e.endpoint.STYLES[t].DIRECTION]=1}return!1}}])}(meister),function(e){e.controller("GatewayClientsDialogController",["$scope","gateway","$location","$mdToast","$mdDialog","GatewayClientService","ClientService","MessageUtil","SYSTEM_ADMIN",function(e,n,t,o,i,l,r,s,a){e.gatewayClients=[],e.types=[],e.clients=[],e.client_id=0,e.type=0,e.gateway=n,e.init=function(){l.getbyGatewayId(n.id).then(function(n){console.log(n),e.gatewayClients=n.data})},e.init(),r.index().then(function(n){e.clients=n.data},function(e){console.log("error",e),s.showError(e.data.error)}),e.delete=function(n,t){var o=i.confirm().title("You are about to delete the following").htmlContent("User "+t.name).targetEvent(n).ok("Yes").cancel("No");i.show(o).then(function(){e.promise=UserClientRoleService.destroy(t.id),e.promise.then(function(e){s.showInfo("User was deleted")},function(e){s.showError(e.data.error)})},function(){})},e.add=function(){if(e.client_id){var n={client_id:e.client_id,gateway_id:e.gateway.id};l.store(n).then(function(n){s.showInfo("Relation created"),e.init()},function(e){console.log(e),s.showError(e.data.error)})}},e.delete=function(n,t){t.$edit=!1,l.destroy(t.id).then(function(n){s.showInfo("Client relation deleted"),e.init()},function(e){s.showError(e.data.error)})},e.close=function(){i.cancel()}}])}(meister),function(e){e.controller("HomeController",["$scope","$rootScope","$mdMenu","$mdToast","$mdDialog","MessageUtil","GatewayService","$filter","$window","GatewayClientService","$timeout",function(e,n,t,o,i,l,r,s,a,c,d,u){e.promise=null,e.gateways=[],e.gatewaySelectedId=null,e.gatewaySelected=null,e.treeOptions={showIcon:!0,expandOnClick:!1},e.nodeSelected=null,e.nodeExpanded=null;var p=null;e.json=null,e.show_select_gateway=!0,e.loading_tree=!1,e.wrap={compression:"N",testRun:!1,callMode:"S",callBack:""},e.jsonReq={},e.jsonResp={},e.opt={selectedIndex:0,show:!1},e.json_global_string="",e.payload_json={json:null,options:{mode:"tree"}},e.payloadsTree=[],e.basicTree=[],e.styleSelected=null,e.styles=[],e.show_select_gateway=!0,e.json_details="",e.json_logs=[],e.json_logs_title=null,e.json_logs_content=null,e.json_logs_content_obj=null,e.json_logs_executes=[],e.json_logs_executes_title=null,e.tree_collapsible=!1,e.tree_collapsible_execute=!1,e.hide_results=!1,e.json_invalid=null,e.url_details="",e.edit={},e.edit.current_long_text="",e.edit.current_description="",e.add_endpoint=!1,e.bapi={},e.bapi_node_is_selected=!1,e.style_template={},e.client={};var g=[],m=[];e.node=null,e.parentNode=null,e.query={limit:10,page:1},e.limitOptions=[10,25,50,100];var f=/(^\$TMP$)|((^(Z|Y)[1-9A-Za-z]+(_[1-9A-Za-z]+)?))|((\/[1-9A-Za-z]+(\/[1-9A-Za-z_]+)(\/[1-9A-Za-z_]+)?(\/[1-9A-Za-z_]+)?)){1,30}/i;e.PACKAGE_PATTERN=f,e.CLASSNAME_PATTERN=/((^(Z|Y)[1-9A-Za-z]+(_[1-9A-Za-z]+)?))|((\/[1-9A-Za-z]+(\/[1-9A-Za-z_]+)(\/[1-9A-Za-z_]+)?(\/[1-9A-Za-z_]+)?)){1,30}/i;var E=function(e){"ace_text-input"!==e.target.getAttribute("class")&&e.preventDefault()};angular.element(a).on("contextmenu",E),e.$on("$destroy",function(){angular.element(a).off("contextmenu",E)}),e.hide_tree=function(){e.tree_collapsible=!0},e.show_tree=function(){e.tree_collapsible=!1},e.hide_tree_execute=function(){e.tree_collapsible_execute=!0},e.show_tree_execute=function(){e.tree_collapsible_execute=!1},e.endpointMainChanged=function(n){if(console.log("endpointMainChanged",n),n)if(n.toUpperCase().startsWith("Z"))e.PACKAGE_PATTERN=/(^\$TMP$|(^(Z)[1-9A-Za-z]+(_[1-9A-Za-z]+)?))/i;else if(n.toUpperCase().startsWith("Y"))e.PACKAGE_PATTERN=/(^\$TMP$|(^(Y)[1-9A-Za-z]+(_[1-9A-Za-z]+)?))/i;else if(n.toUpperCase().startsWith("/")){var t=n.toUpperCase().split("/"),o="";console.log("Split",t);for(var i=0;i<t.length-1;i++)t[i]&&t[i].length>0&&(o+="\\/"+t[i]);e.PACKAGE_PATTERN=new RegExp("^("+o+"\\/)[1-9A-Za-z]+(_[1-9A-Za-z]+)?$","i")}else e.PACKAGE_PATTERN=/ZZZZZZZZZZZZZZZZZZZZZZZZZZZZ/;else e.PACKAGE_PATTERN=f;console.log("Package PATTERN",e.PACKAGE_PATTERN)},e.mode_run=!1,e.init=function(){console.log("home controller init..."),e.promise=r.index(),e.add_endpoint=!1,e.promise.then(function(n){console.log("result",n),e.gateways=n.data},function(e){console.log("failure",e),l.showError(e.data.message)})},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.build_tree=function(t){e.add_endpoint=!1,e.basicTree=[];var o=n.isMeister(),i={name:e.gatewaySelected.name,image:"/public/images/root.png",children:[]};e.mode_run=!1,e.payloadsTree=[],e.payload_json={json:null,options:{mode:"tree"}},e.url_details="",e.styleSelected=null;if(e.basicTree.push(i),console.log("Building tree",p),p&&p.length>0){e.json=p;var l={name:"Logically Deleted",source:i,image:"/public/images/trash.png",parent:i,disabled:!0,is_deleted:"",children:[]};e.bapi={name:"BAPI Processor",source:i,image:"/public/images/bapi.png",parent:i,disabled:!1,is_deleted:"",type:"BAPI_BUTTON",children:[]},i.children.push(e.bapi),_.forEach(e.json,function(n){if(!n.MEISTER_OWN||"X"!=n.MEISTER_OWN||o){var r={name:n.PROJECT,source:n,image:"/public/images/project.png",parent:i,is_deleted:n.LOGICAL_DELETE,children:[]},s={name:"Style Library",image:"/public/images/template.png",type:"STYLE_TEMPLATE_PARENT",parent:n,expanded:!1,children:[]},a={name:"Logically Deleted",source:r,image:"/public/images/trash.png",disabled:!0,parent:n,is_deleted:"",children:[]};_.forEach(n.STYLE_LIB,function(e){var n=0==e.DESCRIPTION.length?e.PKY:e.DESCRIPTION,t={name:n,source:e,type:"style_template",image:"/public/images/style_template.png",is_deleted:e.LOGICAL_DELETE,parent:s};t.is_deleted?(a.children.push(t),1==a.children.length&&s.children.unshift(a)):s.children.push(t)}),r.children.push(s),r.is_deleted?(l.children.push(r),1==l.children.length&&i.children.unshift(l)):i.children.push(r);var c={name:"Logically Deleted",source:r,image:"/public/images/trash.png",disabled:!0,parent:i,is_deleted:"",children:[]};_.forEach(n.MODULES,function(n){if(!n.MEISTER_OWN||"X"!=n.MEISTER_OWN||o){var i={name:n.NAME,source:n,image:"/public/images/module.png",parent:r,is_deleted:n.LOGICAL_DELETE,children:[]};i.is_deleted?(c.children.push(i),1==c.children.length&&r.children.unshift(c)):r.children.push(i);var l={name:"Logically Deleted",source:i,disabled:!0,image:"/public/images/trash.png",parent:r,is_deleted:"",children:[]};_.forEach(n.ENDPOINTS,function(n){if(!n.MEISTER_OWN||"X"!=n.MEISTER_OWN||o){var r=!1;t&&"ENDPOINT"==t.type&&(r=t.value===n.NAMESPACE),g.push(n.NAMESPACE),m.push(n.ENDPOINT_MAIN);var s=h(n),a={name:n.NAMESPACE,source:n,image:s,expanded:!1,selected:r,parent:i,is_deleted:n.LOGICAL_DELETE,children:[]};a.is_deleted?(l.children.push(a),1==l.children.length&&i.children.unshift(l)):i.children.push(a),a.selected&&(e.nodeSelected=a),_.forEach(n.STYLES,function(e){var n={name:e.NAME,source:e,image:"/public/images/styles.png",parent:a,expanded:!1,is_deleted:e.LOGICAL_DELETE,children:[]};a.children.push(n)})}})}})}})}e.$emit("selection-changed",e.nodeSelected)},e.executeGateway=function(n){e.loading_tree=!0,e.nodeSelected=null,e.nodeExpanded=null,e.json_invalid=null,e.show_select_gateway=!1,e.mode_run=!1,e.url_details="",e.styleSelected=null,e.add_endpoint=!1,e.gatewaySelected.id&&(params={},e.client.id&&(params.client_number=e.client.sap_number),console.log(params),e.promise=r.execute(e.gatewaySelected.id,params),e.promise.then(function(t){e.loading_tree=!1,console.log("result",t),p=t.data,l.showInfo("Gateway data loaded"),e.build_tree(n)},function(n){e.loading_tree=!1,console.log("failure",n),l.showError(n.data.message)}))},e.changeGateway=function(n){e.gatewaySelectedId=n,e.add_endpoint=!1,e.json_invalid=null,console.log("Gateway selected",e.gatewaySelectedId),e.gatewaySelected=_.find(e.gateways,function(e){return n==e.id}),e.gatewaySelected&&(e.client={},c.getbyGatewayId(e.gatewaySelectedId).then(function(n){e.clients=n.data,e.clients.length&&(e.client=e.clients[0].client)}))},n.openActionsInNode=function(e,n){console.log("openActionsInNode",n),console.log("mdOpenMenu",e)},e.openActionsInNodeTemp=function(e,n){console.log("openActionsInNodeTemp",n)},e.clear_log_json_result=function(){e.json_details="",e.json_logs=[],e.json_logs_title=null,e.json_logs_content=null,e.json_logs_content_obj=null},e.$on("hide_bapi_node",function(n,t){e.bapi_node_is_selected=!1}),e.$on("execute-bapi-node",function(n,t){console.log("execute-bapi-node",t),e.execute(n,t,t.source.FUNCTION_NAME)}),e.$on("bapi-node-selected",function(n,t){
console.log("BAPI node selected",t),e.mode_run=!1,e.add_endpoint=!1,e.bapi_node_is_selected=!1,e.nodeSelected=t,e.node=t,e.json_invalid=null}),e.$on("bapi-subnode-selected",function(n,t){console.log("BAPI Subnode selected",t),e.mode_run=!1,e.json_invalid=null,e.add_endpoint=!1,e.bapi_node_is_selected=!1,e.node=t,e.nodeSelected=t}),e.$on("bapi-selected",function(n,t){console.log("BAPI",t),e.mode_run=!1,e.json_invalid=null,e.add_endpoint=!1,e.bapi_node_is_selected=!0,e.node=t}),e.$on("selection-changed",function(n,t){console.log("Node selected",t),e.bapi_node_is_selected=!1,e.node=t,e.nodeSelected=t,e.payload_json={json:null,options:{mode:"tree"}},e.url_details="",e.mode_run=!1,e.json_invalid=null,e.styles=[],e.styleSelected=null,t&&t.source&&((!t.type||"style_template"!==t.type&&"STYLE_TEMPLATE_PARENT"!==t.type)&&(e.add_endpoint=!1),t.source.STYLES&&t.source.STYLES.length>0&&(console.log("Styles",t.source.STYLES),e.styles=_.filter(t.children,function(e){return"O"==e.source.DIRECTION})),e.clear_log_json_result(),e.nodeSelected.source.hasOwnProperty("JSON")&&(e.json_global_string=JSON.stringify(JSON.parse(e.nodeSelected.source.JSON),null,"\t")))}),e.$on("action-node-selected",function(n,t){console.log("action-node-selected",t),"addProject"===t.actionName?e.addProject(t.sourceEvent,t.node):"addModule"===t.actionName?e.addModule(t.sourceEvent,t.node):"addEndpoint"==t.actionName?e.addEndpoint(t.sourceEvent,t.node):"add_style_lib"==t.actionName?e.addStyle(t.sourceEvent,t.node.parent,null):"execute"==t.actionName?e.execute(t.sourceEvent,t.node):"execute_by_style"==t.actionName&&e.execute_by_style(t.sourceEvent,t.node)}),e.$on("ondrop-node-style-to-library",function(n,t){console.log("ondrop-node-style-to-library",t),e.addStyle(n,t.library.parent,t.style)}),e.$on("undelete-style-lib",function(n,t){var o=r.buildJsonByNewStyleTemplate(e.json,t.node.parent.parent,t.node.source),i={json:JSON.stringify(o),SDK_HINT:"RLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Style un-deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("delete-style-lib",function(n,t){var o=r.buildJsonByNewStyleTemplate(e.json,t.node.parent.parent,t.node.source),i={json:JSON.stringify(o),SDK_HINT:"SLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Style deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("undelete-module-selected",function(n,t){console.log("undelete-module-selected",t);var o=r.buildJsonByNewModule(e.json,t.node.parent.source,t.node.source);console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"RLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Module un-deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("check-if-undelete-module-selected",function(e,n){console.log("undelete-module-selected",n)}),e.$on("delete-module-selected",function(n,t){console.log("delete-module-selected",t);var o=r.buildJsonByNewModule(e.json,t.node.parent.source,t.node.source);console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"SLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Module deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.formatKey=function(e){var n=e.replace("_"," ");return n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()},e.$on("undelete-project-selected",function(n,t){console.log("undelete-project-selected",t);var o=r.buildJsonByNewProject(e.json,t.node.source);delete o.MODULES,delete o.STYLE_LIB,console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"RLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Project un-deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("delete-project-selected",function(n,t){console.log("delete-project-selected",t);var o=r.buildJsonByNewProject(e.json,t.node.source);delete o.MODULES,delete o.STYLE_LIB,console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"SLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Project deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("undelete-endpoint-deleted",function(n,t){console.log("undelete-endpoint-deleted",t);var o=r.buildJsonByNewEndpoint(e.json,t.node.parent.source,t.node.source);delete o.MODULES[0].ENDPOINTS[0].STYLES,console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"RLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Endpoint un-deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("delete-endpoint-deleted",function(n,t){console.log("delete-endpoint-deleted",t);var o=r.buildJsonByNewEndpoint(e.json,t.node.parent.source,t.node.source);delete o.MODULES[0].ENDPOINTS[0].STYLES,console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"SLD"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(n){console.log("result",n),l.showInfo("Endpoint deleted"),e.executeGateway()},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("lock-endpoint",function(n,t){console.log("lock-endpoint",t);var o=r.buildJsonByNewEndpoint(e.json,t.node.parent.source,t.node.source);delete o.MODULES[0].ENDPOINTS[0].STYLES,console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"SLK"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(e){console.log("result",e),l.showInfo("Endpoint locked"),t.node.source.LOCKED="X",t.node.image=h(t.node.source),t.node.is_lock=!0},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("unlock-endpoint",function(n,t){console.log("unlock-endpoint",t),t.node.is_lock=!1;var o=r.buildJsonByNewEndpoint(e.json,t.node.parent.source,t.node.source);delete o.MODULES[0].ENDPOINTS[0].STYLES,console.log("json_to_send",o);var i={json:angular.toJson(o),SDK_HINT:"RLK"};e.client.id&&(i.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,i),e.promise.then(function(e){console.log("result",e),l.showInfo("Endpoint unlocked"),t.node.source.LOCKED="",t.node.image=h(t.node.source)},function(e){console.log("error",e),l.showError(e.data.message)})}),e.$on("refresh-module",function(n,t){console.log("refresh-module",t);var o=e.basicTree[0].children;_.forEach(o,function(e){var n=e.children;_.forEach(n,function(e){e.nodeId===t&&(e.is_deleted=!1)})})}),e.$on("refresh-project",function(n,t){console.log("refresh-project",t),console.log("basicTree",e.basicTree[0].children);var o=e.basicTree[0].children;_.forEach(o,function(e){e.nodeId===t&&(e.is_deleted=!1)})}),e.addModule=function(n,t){e.mode_run=!1,e.json_invalid=null,i.show({controller:"ModuleDialogController",templateUrl:"templates/module-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{module:null,parentNode:t,gateway:e.gatewaySelected,json:e.json,client:e.client}}).then(function(n){l.showInfo("Module was created"),e.executeGateway()},function(){})},e.addProject=function(n,t){e.mode_run=!1,e.json_invalid=null,i.show({controller:"ProjectDialogController",templateUrl:"templates/project-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{project:null,parentNode:t,gateway:e.gatewaySelected,json:e.json,client:e.client}}).then(function(n){l.showInfo("Project was created"),e.executeGateway()},function(){})},e.$on("add-endpoint-closed",function(n,t){console.log("add-endpoint-closed",t),e.add_endpoint=!1}),e.$on("add-endpoint-saved",function(n,t){console.log("add-endpoint-saved",t),e.add_endpoint=!1,l.showInfo("Endpoint was created");var o={type:"ENDPOINT",value:t.endpoint.NAMESPACE};e.executeGateway(o)}),e.addEndpoint=function(n,t){e.mode_run=!1,e.json_invalid=null,e.add_endpoint=!0,e.parentNode=t,console.log("style Library",e.style_template)},e.addStyle=function(n,t,o){e.mode_run=!1,e.json_invalid=null,i.show({controller:"StyleDialogController",templateUrl:"templates/style-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{style:o,parentNode:t,gateway:e.gatewaySelected,json:e.json,client:e.client}}).then(function(n){l.showInfo("Style was created"),e.executeGateway()},function(){})},e.$watch("payload_json.json_string",function(){if(e.payload_json.json_string)try{var n=e.payload_json.json_string.replace(/"([\w\s]+)":/g,function(e){return e.replace(/\s+/g,"")});e.payload_json.json=JSON.parse(n),e.payload_json.json_test=!0,console.log(JSON.parse(n))}catch(n){return e.payload_json.json_test=!1,!1}}),e.execute=function(n,t,o){var i={endpoint:t.name};o&&(i.endpoint=o);var t={};e.payload_json={json:null,options:{mode:"tree"}},e.json_logs_executes_title=null,e.mode_run=!0,e.client.id&&(i.client_number=e.client.sap_number),t=e.nodeSelected,e.styleSelected=null,e.promise=r.execute_endpoint(e.gatewaySelected.id,i),e.promise.then(function(n){console.log("result",n),e.json_logs_executes_title=null,t.source.TYPE&&"L"==t.source.TYPE?(e.opt.selectedIndex=0,e.opt.show=!0,e.jsonReq=n.data.data.REQUEST,e.jsonResp=n.data.data.RESPONSE,e.payload_json.json=e.jsonReq,e.payload_json.json_string=JSON.stringify(e.jsonReq,null,"\t")):(e.opt.selectedIndex=0,e.opt.show=!1,e.payload_json.json=n.data.data,e.payload_json.json_string=JSON.stringify(n.data.data,null,"\t")),e.payload_json.json_test=!0},function(e){console.log("failure",e),l.showError(e.data.message)})},e.editorLoaded=function(){console.log("broascastng"),e.$broadcast("md-resize-textarea")},e.execute_by_style=function(n,t){console.log("execute_by_style",e.basicTree),e.styleSelected=t,e.execute(n,t.parent)},e.downloadJSON=function(){var n=new Blob([s("json")(e.json_logs_content,2)],{type:"application/json;charset=utf-8;"}),t=angular.element("<a></a>");t.attr("href",window.URL.createObjectURL(n)),t.attr("download","result.json"),t[0].click()},e.execute_details=function(n){var t=null;e.hide_results=!1,e.json_invalid=null,t=e.styleSelected?e.styleSelected.parent:e.nodeSelected,console.log("Execute details event",t);var o={endpoint:t.name,json:JSON.stringify(e.payload_json.json,null,""),Test_Run:"",Asynch:"",Queued:"",BPM:""};switch(e.client.id&&(o.client_number=e.client.sap_number),e.styleSelected&&(o.style=e.styleSelected.name),"N"!=e.wrap.compression&&(o.compression=e.wrap.compression),e.wrap.testRun&&(o.Test_Run="X"),e.wrap.callMode){case"A":o.Asynch="X";break;case"Q":o.Queued="X";break;case"B":o.BPM="X"}var i=new Date;e.promise=r.execute_endpoint(e.gatewaySelected.id,o),e.promise.then(function(n){console.log("result",n);var o=new Date,l=o-i;e.url_details=n.data.url;var r="RUNTIME: "+moment().format("MMMM DD YYYY, h:mm:ss a");if("O"==n.data.compression||"B"==n.data.compression){var s=new Uint8Array(n.data.data),a=pako.inflate(s);json=String.fromCharCode.apply(null,new Uint16Array(a)),json_text_content=angular.fromJson(json)}else json_text_content=n.data.data;console.log("json_text_content",json_text_content);var c={title:r+" - Time Execution: "+l/1e3+" seconds",content:json_text_content},d={title:t.name+"-"+r,nodeSelected:t,opt:e.opt,selectedIndex:e.opt.selectedIndex,payload_json:angular.copy(e.payload_json),styleSelected:e.styleSelected};e.json_logs_title=c.title,e.json_logs_content=c.content,e.json_logs_content_obj=n.data.data,e.json_logs.push(c),e.json_logs_executes.push(d)},function(n){console.log("failure",n),l.showError(n.data.message),n.data.Json&&(e.json_invalid=n.data.Json)})},e.changeJsonLogExecute=function(n){console.log("changeJsonLogExecute",n);var t=_.find(e.json_logs_executes,function(e){return e.title===n});t&&(e.nodeSelected=t.nodeSelected,e.opt=t.opt,e.payload_json=angular.copy(t.payload_json),e.styleSelected=t.styleSelected,console.log(e.payload_json),e.query={limit:10,page:1})},e.changeJsonLog=function(n){console.log("changeJsonLog",n),e.json_logs_title=n;var t=_.find(e.json_logs,function(e){return e.title===n});t&&(e.json_logs_content=t.content,e.json_logs_content_obj=angular.fromJson(t.content),e.query={limit:10,page:1})},e.json_to_string=function(e){return JSON.stringify(e,null,"\t")},e.json_to_object=function(e){try{return JSON.parse(e)}catch(e){return{}}},e.onLoadJson=function(e){e.expandAll()},e.changeStyle=function(n){e.styleSelected=n,e.styleSelected.parent=e.nodeSelected,console.log("changeStyle",e.styleSelected)},e.setRequest=function(){e.payload_json.json=e.jsonReq,e.payload_json.json_string=JSON.stringify(e.jsonReq,null,"\t")},e.setResponse=function(){e.payload_json.json=e.jsonResp,e.payload_json.json_string=JSON.stringify(e.jsonResp,null,"\t")},e.editLongText=function(n,t){n.source.LOCKED||(e.edit.current_long_text=n.source.LONG_TEXT,n.source["LONG_TEXT"+t]={$edit:!0},d(function(){a.document.getElementById("elementF").focus()}))},e.cancelLongText=function(e,n){delete e.source["LONG_TEXT"+n]},e.saveLongText=function(n,t,o){var i=n.source.LONG_TEXT;n.source.LONG_TEXT=o,delete n.source["LONG_TEXT"+t];var s=r.buildJsonByNewEndpoint(e.json,n.parent.source,n.source);delete s.MODULES[0].ENDPOINTS[0].STYLES,console.log("json_to_send",s);var a={json:angular.toJson(s),SDK_HINT:"ELT"};e.client.id&&(a.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,a),e.promise.then(function(e){console.log("result",e)},function(e){console.log("error",e),n.source.LONG_TEXT=i,l.showError(e.data.message)})},e.editDescription=function(n){e.edit.current_description=n.source.DESCRIPTION,n.$edit=!0,d(function(){a.document.getElementById("elementF").focus()})},e.cancelDescription=function(e,n){e.$edit=!1},e.saveDescription=function(n,t){var o=n.source.DESCRIPTION;n.source.DESCRIPTION=t,delete n.$edit;var i=r.buildJsonByNewStyleTemplate(e.json,n.parent.parent,n.source);console.log("json_to_send",i);var s={json:angular.toJson(i),SDK_HINT:"ELT"};e.client.id&&(s.client_number=e.client.sap_number),e.promise=r.execute_changes(e.gatewaySelectedId,s),e.promise.then(function(e){console.log("result",e),n.name=t},function(e){console.log("error",e),n.source.DESCRIPTION=o,l.showError(e.data.message)})};var h=function(e){return e.LOCKED&&"X"===e.LOCKED?"L"==e.TYPE?"/public/images/dendpoint_l.png":"/public/images/dendpoint.png":"L"==e.TYPE?"/public/images/endpoint_l.png":"/public/images/endpoint.png"};e.sizeView=function(){return!e.mode_run||0==e.json_logs.length||e.hide_results?e.tree_collapsible?95:70:e.tree_collapsible?45:35},e.sizeViewExecute=function(){return e.tree_collapsible&&e.tree_collapsible_execute?90:e.tree_collapsible&&!e.tree_collapsible_execute?50:!e.tree_collapsible&&e.tree_collapsible_execute?70:35},e.hideResults=function(){e.hide_results=!0}}])}(meister),function(e){e.controller("LoginController",["$scope","$rootScope","$location","$mdToast","$cookies","AuthenticationService","MessageUtil","COOKIE_LAST_REQUEST",function(e,n,t,o,i,l,r,s){i.remove("meister-sdk-token"),i.remove(s),e.login=function(){e.promise=l.Login(e.username,e.password),e.promise.then(function(e){console.log("Login",e),e.data&&e.data.access_token?t.path("/home"):(i.remove("meister-sdk-token"),r.showError("The user credentials were incorrect"))},function(e){console.log("failure login",e),r.showError("The user credentials were incorrect")})}}])}(meister),function(e){e.controller("MainController",["$scope","$rootScope","$cookies","$location","$timeout","$mdSidenav","$mdMenu","$state","SYSTEM_ADMIN","SYSTEM_INTEGRATOR","CLIENT_ADMIN","CLIENT_USER","AuthenticationService","UserService",function(e,n,t,o,i,l,r,s,a,c,d,u,p,g){function m(e){return function(){l(e).toggle()}}console.log("MainController init"),n.toggleLeft=m("left"),n.toggleRight=m("right"),n.SYSTEM_ADMIN=a,n.CLIENT_ADMIN=d,n.CLIENT_USER=u,n.SYSTEM_INTEGRATOR=c,n.openMenu=function(e,n){e(n)},n.logout=function(){p.Logout().then(function(e){console.log("Logout successful",e),o.path("/login")},function(e){console.log(e)})},n.user_type=function(){var e=t.get("meister-sdk-token");return e?(e=angular.fromJson(e),e.user_type):-1},n.user_client=function(){var e=t.get("meister-sdk-token");return e?(e=angular.fromJson(e),e.user_default_client):-1},n.user_id=function(){var e=t.get("meister-sdk-token");return e?(e=angular.fromJson(e),e.user_id):0},n.clients=function(){var e=t.get("meister-sdk-token");return e?(e=angular.fromJson(e),e.user_clients):[]},n.isMeisterUser=function(e){var o=t.get("meister-sdk-token");return!o||!e.source.MEISTER_OWN||"X"!=e.source.MEISTER_OWN||(o=angular.fromJson(o),o.user_type==n.SYSTEM_ADMIN||o.user_email.endsWith("@s4meister.com")||o.user_email.endsWith("@gameister.com"))},n.isMeister=function(){var e=t.get("meister-sdk-token");return!!e&&(e=angular.fromJson(e),e.user_type==n.SYSTEM_ADMIN||e.user_email.endsWith("@s4meister.com")||e.user_email.endsWith("@gameister.com"))},n.setClientAndType=function(e){var o=t.get("meister-sdk-token");o&&(console.log("change default"+e.client_id),g.changeDefault(e.client_id).then(function(){o=angular.fromJson(o),e.default=1,o.user_default_client=e,o.user_type=e.role.value,_.each(o.user_clients,function(n){n.id==e.id?n.default=1:n.default=0}),t.put("meister-sdk-token",angular.toJson(o)),n.$broadcast("default_client_change",{})}))},n.transition="fade-in"}])}(meister),function(e){e.controller("ModuleDialogController",["$scope","$mdDialog","module","parentNode","gateway","json","client","GatewayService","MessageUtil",function(e,n,t,o,i,l,r,s,a){e.module={},e.promise=null,e.cancel=function(){n.cancel()},t?e.module=angular.copy(t):(e.module.PKY="",e.module.NAME="",e.module.DATE=new Date,e.module.ENDPOINTS=[]),console.log("Module",t),console.log("ParenNode",o),e.save=function(){var t=s.buildJsonByNewModule(l,o.source,e.module),c={json:JSON.stringify(t)};r&&r.id&&(c.client_number=r.sap_number),console.log("params"+c),e.promise=s.execute_changes(i.id,c),e.promise.then(function(e){console.log("result",e),n.hide(e)},function(e){console.log("error",e),a.showError(e.data.message)})}}])}(meister),function(e){e.controller("ProjectDialogController",["$scope","$mdDialog","project","parentNode","gateway","json","client","GatewayService","MessageUtil",function(e,n,t,o,i,l,r,s,a){e.project={},e.promise=null,e.cancel=function(){n.cancel()},t?e.project=angular.copy(t):(e.project.PKY="",e.project.PROJECT=""),console.log("Project",t),console.log("ParenNode",o),e.save=function(){console.log("Saving Project",e.project);var t=s.buildJsonByNewProject(l,e.project);delete t.MODULES,delete t.STYLE_LIB;var o={json:JSON.stringify(t)};r&&r.id&&(o.client_number=r.sap_number),console.log("Params",o),e.promise=s.execute_changes(i.id,o),e.promise.then(function(e){console.log("result",e),n.hide(e)},function(e){console.log("error",e),a.showError(e.data.message)})}}])}(meister),function(e){e.controller("RequestLogsController",["$scope","$rootScope","$location","$mdToast","$mdDialog","MessageUtil","RequestLogService",function(e,n,t,o,i,l,r){e.logs=[],e.promise=null,e.total=0,e.query={limit:5,page:1},e.limitOptions=[5,10,15,20],e.init=function(){console.log("Request log init..."),e.promise=r.index(e.query),e.promise.then(function(n){console.log("result",n),e.logs=n.data.data,e.total=n.data.total,console.log("total",e.total),console.log("size:",s(e.logs))},function(e){console.log("failure",e),l.showError(e.data.message)})},e.deleteAll=function(){console.log("Delete all..."),e.promise=r.deleteAll(),e.promise.then(function(n){console.log("result",n),e.init(),l.showInfo("Log errors deleted")},function(e){console.log("failure",e),l.showError(e.data.message)})};var s=function(e){function n(e){if(null!==e&&void 0!==e)switch(typeof e){case"number":t+=8;break;case"string":t+=2*e.length;break;case"boolean":t+=4;break;case"object":var o=Object.prototype.toString.call(e).slice(8,-1);if("Object"===o||"Array"===o)for(var i in e)e.hasOwnProperty(i)&&n(e[i]);else t+=2*e.toString().length}return t}var t=0;return function(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(3)+" KiB":e<1073741824?(e/1048576).toFixed(3)+" MiB":(e/1073741824).toFixed(3)+" GiB"}(n(e))}}])}(meister),function(e){e.controller("ResponseEndpointExecutionDialogController",["$scope","$mdDialog","json",function(e,n,t){e.json=t,e.cancel=function(){n.cancel()},e.pretty_payload_json=function(e){return angular.toJson(e,!0)}}])}(meister),function(e){e.controller("StyleDialogController",["$scope","$mdDialog","style","parentNode","gateway","json","client","GatewayService","MessageUtil",function(e,n,t,o,i,l,r,s,a){e.style={},e.promise=null,e.cancel=function(){n.cancel()},t?(e.style=angular.copy(t),e.style.PKY="",e.style.DESCRIPTION="",e.style.JSON=JSON.stringify(JSON.parse(e.style.JSON),null,"\t"),delete e.style.CLASS_NAME,delete e.style.DIRECTION,delete e.style.FKY,delete e.style.LOGICAL_DELETE,delete e.style.MEISTER_OWN,delete e.style.NAME):(e.style.PKY="",e.style.DESCRIPTION="",e.style.JSON=""),console.log("Style",e.style),console.log("Parent",o),e.changeJSON=function(n){try{jj=JSON.parse(e.style.JSON),Object.keys(jj).length>0?e.valid=!0:e.valid=!1}catch(n){e.valid=!1}},e.save=function(){e.style.JSON=e.style.JSON.replace(/"([\w\s]+)":/g,function(e){return e.replace(/\s+/g,"")});var t=s.buildJsonByNewStyleTemplate(l,o,e.style);console.log("json_to_send",t);var c={json:JSON.stringify(t,null,""),SDK_HINT:"ADS"};r&&r.id&&(c.client_number=r.sap_number),console.log("params",c),e.promise=s.execute_changes(i.id,c),e.promise.then(function(e){console.log("result",e),n.hide(e)},function(e){console.log("error",e),a.showError(e.data.message)})}}])}(meister),function(e){e.controller("UserClientDialogController",["$scope","user","$location","$mdToast","$mdDialog","UserClientRoleService","UserService","ClientService","MessageUtil","SYSTEM_ADMIN",function(e,n,t,o,i,l,r,s,a,c){e.userClients=[],e.types=[],e.clients=[],e.client_id=0,e.type=0,e.user=n,r.types().then(function(n){e.types=_.filter(n.data,function(e){return e.id!=c})},function(e){console.log("error",e),a.showError(e.data.message)}),e.init=function(){l.getByUserId(n.id).then(function(n){console.log(n),e.userClients=n.data})},e.init(),s.index().then(function(n){e.clients=n.data},function(e){console.log("error",e),a.showError(e.data.message)}),e.delete=function(n,t){var o=i.confirm().title("You are about to delete the following").htmlContent("User "+t.name).targetEvent(n).ok("Yes").cancel("No");i.show(o).then(function(){e.promise=l.destroy(t.id),e.promise.then(function(e){a.showInfo("User was deleted")},function(e){a.showError(e.data.message)})},function(){})},e.add=function(){if(e.client_id&&e.type){var n={client_id:e.client_id,user_id:e.user.id,role_id:e.type,default:0};l.store(n).then(function(n){a.showInfo("Relation created"),e.init()},function(e){a.showError(e.data.message)})}},e.edit=function(e,n){n.$edit=!0,n.$typeValue=n.role.value},e.cancel=function(e,n){n.$edit=!1},e.save=function(n,t){t.$edit=!1,t.role_id=t.$typeValue,l.update(t.id,t).then(function(n){a.showInfo("Permission updated"),e.init()},function(e){a.showError(e.data.message)})},e.delete=function(n,t){t.$edit=!1,l.destroy(t.id).then(function(n){a.showInfo("Permission deleted"),e.init()},function(e){a.showError(e.data.message)})},e.close=function(){i.cancel()}}])}(meister),function(e){e.controller("UserController",["$scope","$rootScope","$location","$mdToast","$mdDialog","UserService","MessageUtil","SYSTEM_ADMIN","SYSTEM_INTEGRATOR","CLIENT_ADMIN","CLIENT_USER",function(e,n,t,o,i,l,r,s,a,c,d){e.users=[],e.promise=null,e.filter={show:!1},e.query={order:"email",limit:5,page:1,filterByEmail:"",filterByFirstName:"",filterByLastName:""},e.limitOptions=[5,10,25,50,100],e.removeFilter=function(){e.filter.show=!1,e.query.filterByEmail="",e.query.filterByFirstName="",e.query.filterByLastName=""},e.init=function(){console.log("UserController init..."),e.promise=l.index(),e.promise.then(function(n){console.log("result",n),e.users=n.data},function(e){console.log("failure login",e),r.showError(e.data.message)})},n.$on("default_client_change",function(){e.init()}),e.add=function(n,t){i.show({controller:"UserDialogController",templateUrl:"templates/user-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{user:null}}).then(function(n){r.showInfo("User was created"),e.init()},function(){})},e.edit=function(n,t){i.show({controller:"UserDialogController",templateUrl:"templates/user-dialog-form.html",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!1,escapeToClose:!1,locals:{user:t}}).then(function(n){r.showInfo("User was updated"),e.init()},function(){})},e.editClient=function(e,n){i.show({controller:"UserClientDialogController",templateUrl:"templates/user-client-dialog-form.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!1,escapeToClose:!1,locals:{user:n}}).then(function(e){},function(){})},e.type=function(e){if(e.type==s)return"SYSTEM_ADMIN";var n=_.find(e.clients,function(e){return e.default});return n.role.value==a?"SYSTEM_INTEGRATOR":n.role.value==c?"CLIENT_ADMIN":n.role.value==d?"CLIENT_USER":void 0},e.delete=function(n,t){var o=i.confirm().title("You are about to delete the following").htmlContent("User "+t.name).targetEvent(n).ok("Yes").cancel("No");i.show(o).then(function(){e.promise=l.destroy(t.id),e.promise.then(function(n){r.showInfo("User was deleted"),e.init()},function(e){r.showError(e.data.message)})},function(){})}}])}(meister),function(e){e.controller("UserDialogController",["$scope","$rootScope","$mdDialog","user","ClientService","UserService","MessageUtil",function(e,n,t,o,i,l,r){e.user={},e.types=[],e.clients=[],e.promise=null,e.cancel=function(){t.cancel()},o?(e.user=angular.copy(o),e.user.password="",e.repassword=""):(e.user.email="",e.user.first_name="",e.user.last_name="",e.user.password="",e.repassword="",e.user.type=n.CLIENT_USER,e.user.client_id=null),console.log("User",o),n.user_type()==n.SYSTEM_ADMIN?i.index().then(function(n){e.clients=n.data,e.user.id||(e.user.client_id=n.data[0].id)},function(e){console.log("error",e),r.showError(e.data.message)}):(e.clients=[n.user_client().client],e.user.client_id=n.user_client().client.id),l.types().then(function(n){e.types=n.data},function(e){console.log("error",e),r.showError(e.data.message)}),e.save=function(){e.user.id?(""==e.user.password&&delete e.user.password,e.promise=l.update(e.user.id,e.user)):e.promise=l.store(e.user),e.promise.then(function(e){console.log("result",e),t.hide(e)},function(e){console.log("error",e),r.showError(e.data.message)})}}])}(meister),function(e){"use strict";e.module("TreeWidget",["ngAnimate","RecursionHelper","ang-drag-drop"]).directive("tree",["$rootScope",function(e){return{restrict:"E",scope:{nodes:"=",options:"=?"},template:"<treenode nodes='nodes' oncontextmenu='return false' tree='nodelist' options='options'></treenode>",compile:function(e,n,t){return{pre:function(e){function n(t,o){if(void 0!=t&&t.length>0)for(var i=0;i<t.length;i++){var l=t[i];void 0===l.nodeId&&(l.nodeId=10*Math.random()+1,e.count++),void 0===l.expanded&&void 0!=l.children&&(l.expanded=!0),void 0!=o&&(l.parentId=o.nodeId),-1==e.nodelist.indexOf(l)&&e.nodelist.push(l),n(l.children,l)}}e.nodelist=[],e.options=e.options||(e.options={showIcon:!0,expandOnClick:!1,multipleSelect:!1}),e.count=0,e.$watch(function(){n(e.nodes)})}}}}}]).filter("nodeFilter",["$filter",function(n){return function(t,o){var i=function(t,o){var l=[];return e.forEach(t,function(t){if(n("filter")([t],o).length>0)l.push(t);else if(e.isArray(t.children)&&t.children.length>0){var r=i(t.children,o);r.length>0&&l.push(t)}}),l};return i(t,o)}}]).directive("treeActions",["$rootScope",function(e){return{controller:function(e){e.emitActionNodeSelected=function(n,t,o){e.$emit("action-node-selected",{actionName:n,node:t,sourceEvent:o})},e.emitDeleteStyleSelected=function(n,t,o){e.$emit("delete-node-style-selected",{actionName:n,node:t,sourceEvent:o})},e.emitUndeleteEndPointSelected=function(n,t,o){e.$emit("undelete-endpoint-deleted",{actionName:n,node:t,sourceEvent:o})},e.emitLockEndPointSelected=function(n,t,o){e.$emit("lock-endpoint",{actionName:n,node:t,sourceEvent:o})},e.emitUnLockEndPointSelected=function(n,t,o){e.$emit("unlock-endpoint",{actionName:n,node:t,sourceEvent:o})},e.emitDeleteEndPointSelected=function(n,t,o){e.$emit("delete-endpoint-deleted",{actionName:n,node:t,sourceEvent:o})},e.emitDeleteStyleLibSelected=function(n,t,o){e.$emit("delete-style-lib",{actionName:n,node:t,sourceEvent:o})},e.emitUndeleteStyleLibSelected=function(n,t,o){e.$emit("undelete-style-lib",{actionName:n,node:t,sourceEvent:o})},e.emitExecuteBAPINode=function(n,t){e.$emit("execute-bapi-node",n)},e.emitUndeleteModuleSelected=function(n,t,o){e.$emit("undelete-module-selected",{actionName:n,node:t,sourceEvent:o})},e.emitDeleteModuleSelected=function(n,t,o){e.$emit("delete-module-selected",{actionName:n,node:t,sourceEvent:o})},e.emitUndeleteProjectSelected=function(n,t,o){e.$emit("undelete-project-selected",{actionName:n,node:t,sourceEvent:o})},e.emitDeleteProjectSelected=function(n,t,o){e.$emit("delete-project-selected",{actionName:n,node:t,sourceEvent:o})},e.canBeDeleted=function(e){var n=!0;return _.forEach(e.children,function(e){return e.source&&"X"!=e.source.LOGICAL_DELETE&&1!=e.disabled?(n=!1,!1):e.type&&"STYLE_TEMPLATE_PARENT"==e.type&&_.find(e.children,function(e){return 1!=e.disabled&&"X"!=e.source.LOGICAL_DELETE})?(n=!1,!1):void 0}),n},e.showMenu=function(e){return"STYLE_TEMPLATE_PARENT"==e.type||!e.parent||!(e.parent.source&&e.parent.source.STYLES||"style_template"==e.type&&!e.source)}},restrict:"E",
template:'<md-menu-item ng-if="node && !node.parent"> <md-button        ng-click="emitActionNodeSelected(\'addProject\',node,$event)"  >     <md-icon ng-bind="\'note_add\'"></md-icon> Add Project  </md-button></md-menu-item><md-menu-item ng-if="node && node.parent  && node.source.MODULES && !node.is_deleted && $root.isMeisterUser(node)"> <md-button        ng-click="emitActionNodeSelected(\'addModule\',node,$event)"  >     <md-icon ng-bind="\'note_add\'"></md-icon> Add module  </md-button></md-menu-item><md-menu-item ng-if="node && node.parent && node.source.MODULES && !node.is_deleted && canBeDeleted(node) && $root.isMeisterUser(node)"> <md-button       ng-click="emitDeleteProjectSelected(\'delete_project\',node,$event)"  >     <md-icon ng-bind="\'delete\'"></md-icon> Delete  </md-button>         </md-menu-item><md-menu-item ng-if="node && node.parent && node.source.MODULES && node.is_deleted && $root.isMeisterUser(node)"> <md-button       ng-click="emitUndeleteProjectSelected(\'delete_project\',node,$event)"  >     <md-icon ng-bind="\'restore_from_trash\'"></md-icon> Undelete  </md-button>         </md-menu-item><md-menu-item ng-if="node && node.parent && node.source.ENDPOINTS && !node.is_deleted && $root.isMeisterUser(node)"> <md-button       ng-click="emitActionNodeSelected(\'addEndpoint\',node,$event)"  >     <md-icon ng-bind="\'note_add\'"></md-icon> Add endpoint  </md-button></md-menu-item>  <md-menu-item ng-if="node && node.parent && node.source.ENDPOINTS && !node.is_deleted && canBeDeleted(node) && $root.isMeisterUser(node)"> <md-button      ng-click="emitDeleteModuleSelected(\'delete_module_selected\',node,$event)"  >     <md-icon ng-bind="\'delete\'"></md-icon> Delete  </md-button>         </md-menu-item><md-menu-item ng-if="node && node.parent && node.source.ENDPOINTS && node.is_deleted && $root.isMeisterUser(node)"> <md-button      ng-click="emitUndeleteModuleSelected(\'undelete_module_selected\',node,$event)"  >     <md-icon ng-bind="\'restore_from_trash\'"></md-icon> Undelete  </md-button>         </md-menu-item><md-menu-item ng-if="node && node.parent && node.source.STYLES && !node.is_deleted && !node.source.LOCKED && $root.isMeisterUser(node)"> <md-button       ng-click="emitLockEndPointSelected(\'lock_endpoint\',node,$event)"  >     <md-icon ng-bind="\'lock\'"></md-icon> Lock  </md-button></md-menu-item><md-menu-item ng-if="node && node.parent && node.source.STYLES && !node.is_deleted && node.source.LOCKED && $root.isMeisterUser(node)"> <md-button       ng-click="emitUnLockEndPointSelected(\'unlock_endpoint\',node,$event)"  >     <md-icon ng-bind="\'lock_open\'"></md-icon> UnLock  </md-button></md-menu-item>         <md-menu-item ng-if="node && node.parent && node.source.STYLES && node.is_deleted && $root.isMeisterUser(node)"> <md-button        ng-click="emitUndeleteEndPointSelected(\'undelete_endpoint_deleted\',node,$event)"  >     <md-icon ng-bind="\'restore_from_trash\'"></md-icon> Undelete  </md-button>         </md-menu-item>         <md-menu-item ng-if="node  && node.source.STYLES && !node.is_deleted"> <md-button        ng-click="emitActionNodeSelected(\'execute\',node,$event)"  >     <md-icon ng-bind="\'send\'"></md-icon> Execute  </md-button>         </md-menu-item>         <md-menu-item ng-if="node && node.parent && node.source.STYLES && !node.is_deleted && $root.isMeisterUser(node)"> <md-button        ng-click="emitDeleteEndPointSelected(\'delete_endpoint_deleted\',node,$event)"  >     <md-icon ng-bind="\'delete\'"></md-icon> Delete  </md-button>         </md-menu-item>         <md-menu-item ng-if="node.parent && !node.type && !node.source.MODULES && !node.source.ENDPOINTS && !node.source.STYLES && !node.is_deleted && showMenu(node)"> <md-button        ng-click="emitActionNodeSelected(\'execute_by_style\',node,$event)"  >     <md-icon ng-bind="\'send\'"></md-icon> Execute  </md-button>         </md-menu-item><md-menu-item ng-if="node.parent && !node.type && !node.source.MODULES && !node.source.ENDPOINTS && !node.source.STYLES && !node.is_deleted && $root.isMeisterUser(node) &&  showMenu(node)"> <md-button        ng-click="emitDeleteStyleSelected(\'deleting_node\',node,$event)"  >     <md-icon ng-bind="\'delete\'"></md-icon> Delete  </md-button></md-menu-item><md-menu-item ng-if="node  && node.type && node.type==\'STYLE_TEMPLATE_PARENT\' "> <md-button      ng-click="emitActionNodeSelected(\'add_style_lib\',node,$event)"  >     <md-icon ng-bind="\'note_add\'"></md-icon> Add style  </md-button></md-menu-item><md-menu-item ng-if="node && node.parent && node.type && node.type==\'style_template\' && !node.is_deleted && canBeDeleted(node) && $root.isMeisterUser(node) && showMenu(node)"> <md-button      ng-click="emitDeleteStyleLibSelected(\'delete_style_lib_selected\',node,$event)"  >     <md-icon ng-bind="\'delete\'"></md-icon> Delete  </md-button></md-menu-item><md-menu-item ng-if="node && node.parent && node.type && node.type==\'style_template\' && node.is_deleted && $root.isMeisterUser(node)"> <md-button      ng-click="emitUndeleteStyleLibSelected(\'undelete_style_lib_selected\',node,$event)"  >     <md-icon ng-bind="\'restore_from_trash\'"></md-icon> Undelete  </md-button></md-menu-item><md-menu-item ng-if="node && (node.type == \'BAPI_SUBNODE\' || node.type == \'BAPI_NODE\') "> <md-button        ng-click="emitExecuteBAPINode(node,$event)"  ><md-icon ng-bind="\'send\'"></md-icon> Execute  </md-button></md-menu-item>'.replace(/md-menu-item/g,"md-list-item")}}]).directive("treenode",["RecursionHelper","$timeout","$rootScope",function(n,t,o){return{restrict:"E",scope:{nodes:"=",tree:"=",options:"=?"},template:'<ul ng-class="{\'tree\':nodes[0].parent,\'special-tree\':!nodes[0].parent}" oncontextmenu="return false" ><li ng-repeat="node in nodes | nodeFilter:options.filter track by node.nodeId"class="node" id="{{::node.nodeId}}" ><i class="tree-node-ico pointer" ng-if="node.children && node.children.length>0" ng-class="{\'tree-node-expanded\': node.expanded && (node.children | nodeFilter:options.filter).length > 0,\'tree-node-collapsed\':!node.expanded && (node.children | nodeFilter:options.filter).length > 0}" ng-click="toggleNode(node)"></i><span class="node-title pointer" ng-click="selectNode(node, $event)" ng-class="{\'disabled\':node.disabled}" ui-draggable="node.parent && ((!node.type && !node.source.MODULES && !node.source.ENDPOINTS && !node.source.STYLES) || (node.type && node.type == \'style_template\')) && !node.is_deleted" drag="node.source" ui-on-Drop="onDropNodeInTree($event,$data,node)"><span><i class="tree-node-ico" ng-if="options.showIcon" ng-class="{\'tree-node-image\':node.children, \'tree-node-leaf\':!node.children}" ng-style="node.image && {\'background-image\':\'url(\'+node.image+\')\'}"></i>     <span class="node-name" tabindex="{{::(node.focusable ? 0 : -1)}}" ng-class="{selected: node.selected&& !node.disabled}"> <span ng-if="!showMenu(node)">{{node.name}}</span> <md-menu ng-if="showMenu(node)">     <span ng-click="$mdMenu.open()"  ng-mouseup="openMenu($mdOpenMenu,$event,node)">       {{node.name}}     </span>     <md-menu-content  oncontextmenu="return false" ><tree-actions></tree-actions> </md-menu-content> </md-menu>         <span ng-if="node.badge != null" class="label" ng-class="node.badge.type">{{node.badge.title}}</span>     </span></span></span><treenode ng-if="node.children && node.expanded" nodes=\'node.children\' tree="tree" options="options"></treenode></li></ul>',compile:function(o){return n.compile(o,function(n,o,i,l,r){function s(t){e.forEach(n.tree,function(e){t!=e&&(e.selected=!1)})}function a(){return n.tree.filter(function(e){return e.selected})}n.selectNode=function(e,t){if(!e.disabled){var o;if(!0===n.options.multipleSelect?(e.selected=!e.selected,o=a()):"ctrlKey"===n.options.multipleSelect||"altKey"===n.options.multipleSelect?(t[n.options.multipleSelect]?e.selected=!e.selected:(e.selected=!0,s(e)),o=a()):(e.selected=!0,s(e),o=e),"BAPI_BUTTON"==e.type)return e.selected=!0,void n.$emit("bapi-selected",e);if("BAPI_NODE"==e.type)return e.selected=!0,void n.$emit("bapi-node-selected",e);if("BAPI_SUBNODE"==e.type)return e.selected=!0,void n.$emit("bapi-subnode-selected",e);n.$emit("selection-changed",o),n.options.onSelectNode&&n.options.onSelectNode(o),n.options.expandOnClick&&void 0!=e.children&&(e.expanded=!e.expanded,n.$emit("expanded-state-changed",e),n.options.onExpandNode&&n.options.onExpandNode(e))}},n.toggleNode=function(e){void 0!=e.children&&(e.expanded=!e.expanded,n.$emit("expanded-state-changed",e),n.options.onExpandNode&&n.options.onExpandNode(e))},n.canBeDeleted=function(e){var n=!0;return _.forEach(e.children,function(e){if(e.source&&"X"!=e.source.LOGICAL_DELETE)return n=!1,!1}),n},n.onDropNodeInTree=function(e,n,t){console.log("onDrop",n),"STYLE_TEMPLATE_PARENT"==t.type&&(console.log("it's supported STYLE LIBRARY"),$scope.$emit("ondrop-node-style-to-library",{actionName:"ondrop-node-style-to-library",library:t,style:n,sourceEvent:e}))},n.showMenu=function(e){return"STYLE_TEMPLATE_PARENT"==e.type||!e.parent||!(e.parent.source&&e.parent.source.STYLES||"style_template"==e.type&&!e.source)},n.openMenu=function(e,n,o){if(3==n.which){var i=a();n.preventDefault(),n.stopPropagation(),1==i.length&&i[0].nodeId==o.nodeId&&(e(n),t(function(){document.getElementsByClassName("md-menu-backdrop")[0].oncontextmenu=function(){return!1}}))}}})}}}])}(angular),function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(e){var n=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(n,t,o,i,l,r){function s(){o.cancel(c),r.complete(),u=0,d=0}function a(n){var o,i=t.get("$http"),l=e.defaults;!n.cache&&!l.cache||!1===n.cache||"GET"!==n.method&&"JSONP"!==n.method||(o=angular.isObject(n.cache)?n.cache:angular.isObject(l.cache)?l.cache:i);var r=void 0!==o&&void 0!==o.get(n.url);return void 0!==n.cached&&r!==n.cached?n.cached:(n.cached=r,r)}var c,d=0,u=0,p=r.latencyThreshold;return{request:function(e){return e.ignoreLoadingBar||a(e)||(i.$broadcast("cfpLoadingBar:loading",{url:e.url}),0===d&&(c=o(function(){r.start()},p)),d++,r.set(u/d)),e},response:function(e){return e&&e.config?(e.config.ignoreLoadingBar||a(e.config)||(u++,i.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),u>=d?s():r.set(u/d)),e):(l.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),e)},responseError:function(e){return e&&e.config?(e.config.ignoreLoadingBar||a(e.config)||(u++,i.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),u>=d?s():r.set(u/d)),n.reject(e)):(l.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),n.reject(e))}}}];e.interceptors.push(n)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(e,n,t,o){function i(){if(d||(d=e.get("$animate")),t.cancel(p),!E){var i=n[0],r=i.querySelector?i.querySelector(g):n.find(g)[0];r||(r=i.getElementsByTagName("body")[0]);var s=angular.element(r),a=r.lastChild&&angular.element(r.lastChild);o.$broadcast("cfpLoadingBar:started"),E=!0,N&&d.enter(m,s,a),y&&d.enter(_,s,m),l(T)}}function l(e){if(E){var n=100*e+"%";f.css("width",n),h=e,S&&(t.cancel(u),u=t(function(){r()},250))}}function r(){if(!(s()>=1)){var e=0,n=s();n>=0&&n<.25?e=(3*Math.random()+3)/100:n>=.25&&n<.65?e=3*Math.random()/100:n>=.65&&n<.9?e=2*Math.random()/100:n>=.9&&n<.99?e=.005:(e=0,l(0));l(s()+e)}}function s(){return h}function a(){h=0,E=!1}function c(){d||(d=e.get("$animate")),o.$broadcast("cfpLoadingBar:completed"),l(1),t.cancel(p),p=t(function(){var e=d.leave(m,a);e&&e.then&&e.then(a),d.leave(_)},500)}var d,u,p,g=this.parentSelector,m=angular.element(this.loadingBarTemplate),f=m.find("div").eq(0),_=angular.element(this.spinnerTemplate),E=!1,h=0,S=this.autoIncrement,y=this.includeSpinner,N=this.includeBar,T=this.startSize;return{start:i,set:l,status:s,inc:r,complete:c,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}(),function(e){e.directive("mainFooter",function(){return{restrict:"E",templateUrl:"templates/main-footer.html"}})}(meister),function(e){e.directive("mainMenu",function(){return{controller:function(e,n,t,o,i){var l=function(){e.user_type=n.user_type()};l(),n.$on("default_client_change",function(){l()})},restrict:"E",templateUrl:"templates/main-menu.html"}})}(meister),function(e){e.directive("mainToolbar",function(){return{controller:function(e,n,t,o,i){var l=function(){e.clients=n.clients(),e.default_client=n.user_client(),e.showMenu=n.user_type()!=n.SYSTEM_ADMIN};l(),n.$on("default_client_change",function(){l()})},restrict:"E",templateUrl:"templates/main-toolbar.html"}})}(meister);